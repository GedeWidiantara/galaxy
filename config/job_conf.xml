<?xml version="1.0"?>
<job_conf>
    <plugins>
        <!-- Define the Docker Runner -->
        <plugin id="docker" type="runner" load="galaxy.jobs.runners.docker:DockerJobRunner"/>
    </plugins>
    
    <destinations>
        <!-- Use Docker for all jobs -->
        <destination id="docker_destination" runner="docker">
            <param id="docker_enabled">true</param>
            <!-- Important: Pass resource limits to the Docker container -->
            <param id="docker_memory">8G</param>
            <param id="docker_cpu">4</param>
            <param id="docker_sudo">false</param>
            <param id="docker_auto_rm">true</param>
            <param id="docker_set_user">1000</param> <!-- Match galaxy user ID -->
        </destination>
    </destinations>
    
    <tools>
        <tool id="upload1" destination="docker_destination" />
    </tools>
    
    <limits>
        <limit type="registered_user_concurrent_jobs">4</limit>
        <limit type="anonymous_concurrent_jobs">1</limit>
    </limits>
</job_conf>
